<html>
    <script src="js/jquery.js" ></script>
    <script>
       var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-19165966-4"]);_gaq.push(["_trackPageview"]);(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="https://ssl.google-analytics.com/ga.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)})();var messages="";function returnMessages(){return messages}function getData(){$.ajax({url:"http://s347232277.online.de/chromefb/?mode=start",success:function(a){try{var c=jQuery.parseJSON(a);if(c.noFacebookRights!=undefined){getFbRights("http://s347232277.online.de/chromefb/?mode=start&fbCon=true")}else{showMessages()}}catch(b){console.log(b)}}})}function countFbMessages(){$.ajax({url:"http://s347232277.online.de/chromefb/?mode=showMessages",success:function(b){try{var d=jQuery.parseJSON(b);if(d.noFacebookRights!=undefined){getFbRights("http://s347232277.online.de/chromefb/?mode=start&fbCon=true")}else{var a=d.messages[0].unread_count;chrome.browserAction.setBadgeText({text:" "+a});if(a!="0"){chrome.browserAction.setIcon({path:"iconActive.png"})}else{chrome.browserAction.setIcon({path:"icon.png"});chrome.browserAction.setBadgeText({text:""})}try{if(typeof messages.messageInformation!="undefined"&&messages.messageInformation.length!=0){console.log(messages.messageInformation[0].thread_id,d.messageInformation[0].thread_id,(messages.messageInformation[0].thread_id!=d.messageInformation[0].thread_id));if(messages.messageInformation[0].thread_id!=d.messageInformation[0].thread_id){showNoti(d.messageInformation[0])}}else{if(typeof d.messageInformation!="undefined"&&d.messageInformation.length!=0){showNoti(d.messageInformation[0])}}}catch(c){console.log(c)}messages=d}}catch(c){console.log(c)}}})}function showMessages(){$.ajax({url:"http://s347232277.online.de/chromefb/?mode=showMessages",success:function(a){try{var c=jQuery.parseJSON(a);if(c.noFacebookRights!=undefined){getFbRights("http://s347232277.online.de/chromefb/?mode=start&fbCon=true")}else{$.each(c.messageInformation,function(d){console.log(d)})}}catch(b){console.log(b,a)}}})}function show(a){getData()}function getFbRights(a){chrome.tabs.create({url:a})}function showNoti(b){var a='<p class="right text"><a class="author">'+b.name+"</a><br/>"+b.snippet+"</p> </div>";var c=webkitNotifications.createNotification(b.pic_square,b.name,b.snippet);c.show();(function(d){$(c).bind("click",function(f){var g=d.thread_id.replace("t_","");var e="http://www.facebook.com/?sk=inbox&action=read&tid="+g;getFbRights(e)})})(b)}function showNot(b){var a=webkitNotifications.createHTMLNotification(b);a.show()}if(webkitNotifications){show()}function buildHtml(){}buildHtml.prototype.init=function(a){this.htmlReturn="";this.innerHtmlData=a;this.buildHead();return this.htmlReturn};buildHtml.prototype.buildHead=function(){this.htmlReturn="<html><head><title>TestNotification</title></head><body><p>"+this.innerHtmlData+"</p></body></html>"};setInterval(countFbMessages,10000);
    </script>
</html>